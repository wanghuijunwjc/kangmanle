<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<link rel="stylesheet" type="text/css" href="css/show.css">
	</head>
	<body>
		<header>
			<div>
				<img src="img/1.jpg">
				<a href="">收藏康满乐</a>
				<ul>
					<li id="yonghu">您好！ 欢迎光临本店！<a href="login.html">[登录]</a> <a href="zhuce.html">[会员注册]</a></li>
					<li>|</li>
					<li><a href="dingdan.html">我的订单</a></li>
					<li>|</li>
					<li id="fuwu">客户服务<span> &or;</span>
						<ol>
							<li><a href="">售后服务</a></li>					
							<li><a href="">在线服务</a></li>					
							<li><a href="">联系我们</a></li>
							<li><a href="">投诉中心</a></li>
						</ol>
					</li>
					<li>|</li>
					<li id="daohang">网站导航 <span>&or;</span>
						<ol>
							<div>
								<li><strong>特色栏目</strong></li>
								<li><a href="">Vip直通车</a></li>
								<li><a href="">三折区</a></li>
								<li><a href="">折扣区</a></li>
								<li><a href="">平价区</a></li>
								<li><a href="">行业资讯</a></li>
							</div>
							<div>
								<li><strong>特色产品</strong></li>
								<li><a href="">搜乐洗衣液</a></li>
								<li><a href="">搜乐卫生巾</a></li>
								<li><a href="">折搜乐洗手液</a></li>
							</div>
						</ol>
						
					</li>
					<li class="hy"><a><img src="img/2.jpg" style="width: 14px;">会员中心 <span>&or;</span></a>
						<div id="huiyuan">
							<div id="xiaokuang">您好，<a href="login.html">请登录，</a> <a href="zhuce.html">会员注册</a></div>
							<div>
								<div id="zuo">
									<p><a href="">待处理订单</a></p>
									<p><a href="">咨询回复</a></p>
								</div>
								<div id="you">
									<p><a href="">我的订单</a></p>
									<p><a href="">我的关注</a></p>
									<p><a href="">我的积分</a></p>
								</div>
							</div>
							<div id="liulan">
								最近浏览的商品：
							</div>
						</div>
					</li>
					<li id="shuliang"><a href="cart.html">购物车有0件商品，总价格为￥0元</a></li>
				</ul>
			</div>
		</header>
		<!--************logo***********-->
		<div id="logo">
			<img src="img/3.jpg" onclick="index.html">
			<div>
				<input type="text">
				<input type="button" value="搜索" style="color: #fff;">
				<a href="">搜乐洗衣液</a>
				<a href="">搜乐卫生巾</a>
				<a href="">欧卡姿面膜</a>
			</div>
			<img src="img/4.jpg">
		</div>
		<!--***********nav***************-->
		<nav>
			<ul>
				<li class="xiala"><a href="">全部商品分类</a>
					<ol>
						<li>
							<h4><a href="">Vip直通车</a></h4>
							<a href="">会员套餐</a>
							<a href="">搜乐套餐</a>
						</li>
						<li>
							<h4><a href="">康满乐三折区</a></h4>
							<a href="">日常护理</a>
							<a href="">功能保健</a>
							<a href="">女性特护</a>
							<a href="">健康食品</a>
							<a href="">品味生活</a>
						</li>
						<li>
							<h4><a href="">康满乐折扣区</a></h4>
							<a href="">日常护理</a>
							<a href="">健康养生</a>
							<a href="">功能保健</a>
							<a href="">品味生活</a>
						</li>
						<li>
							<h4><a href="">康满乐平价区</a></h4>
							<a href="">个护化妆</a>
							<a href="">服装鞋帽</a>
							<a href="">家具电器</a>
							<a href="">饮食特产</a>
							<a href="">皮具箱包</a>
							<a href="">养生保健</a>
						</li>
					</ol>
				</li>
				<li><a href="index.html">首页</a></li>
				<li><a href="">VIP直通车</a></li>
				<li><a href="">三折区</a></li>
				<li><a href="">折扣区</a></li>
				<li><a href="">平价区</a></li>
				<li><a href="">众筹专区</a></li>
				<li><a href="">行业资讯</a></li>
				<li><a href="">收费标准</a></li>
			</ul>
		</nav>
		<aside>
			<div id="box">
				<div id="left">
					<div id="div1">
						<img id="small">
						<div id="glass"></div>
					</div>
					<div id="div2">
						<img id="big">
					</div>
				</div>
				<div id="center">
					<h2 id="h"></h2>
					<p id="price"></p>
					<h5 id="kucun"></h5>
					<div id="changeNum">
						<input type="text" />
						<input type="button" value="+" />
						<input type="button" value="-" />
					</div>
					<span id="addbtn"></span>
					<span id="addbtncart"></span>
				</div>
				<div id="right">
					<p id="pinpai"></p>
					<p id="shangjia"></p>
					<p id="spbianhao"></p>
				</div>
			</div>
			<div id="xiaolun">
				<div>&laquo;</div>
				<div id="zhong"></div>
				<div>&raquo;</div>
			</div>
		</aside>
		
		<!--**********************footer***************************-->
		<footer>
			<div>
				<img src="img/footer1.jpg">
				<img src="img/footer2.jpg">
				<img src="img/footer3.jpg">
				<img src="img/footer4.jpg">
			</div>
			<div>
				<ul>
					<li>联系我们</li>
					<li><a href="">联系我们</a></li>
					<li><a href="">网站故障报告</a></li>
					<li><a href="">选购咨询</a></li>
					<li><a href="">投诉与建议</a></li>
				</ul>
				<ul>
					<li>新手上路</li>
					<li><a href="">购物流程</a></li>
					<li><a href="">如何注册</a></li>
					<li><a href="">康满乐介绍</a></li>
					<li><a href="">资费标准</a></li>
				</ul>
				<ul>
					<li>商品管理</li>
					<li><a href="">上架总则</a></li>
					<li><a href="">上架细则</a></li>
					<li><a href="">下架细则</a></li>
				</ul>
				<ul>
					<li>配送与支付</li>
					<li><a href="">货到付款区域</a></li>
					<li><a href="">配送方式说明</a></li>
					<li><a href="">支付方式说明</a></li>
				</ul>
				<ul>
					<li>服务保证</li>
					<li><a href="">退换货原则</a></li>
					<li><a href="">售后服务保证</a></li>
					<li><a href="">产品质量保证</a></li>
					<li><a href="">退换货流程</a></li>
				</ul>
			</div>
			<div>
				<span>Copyright&copy;2017康满乐商城  浙ICP备16026032号-2 </span>
				<a href=""><img src="img/zhan.gif"></a>
			</div>
			<div>
				<a href=""><img src="img/cnnic.png"></a>
				<a href=""><img src="img/hy_124x47.png"></a>
				<a href=""><img src="img/bottom_large_img.png"></a>
			</div>
		</footer>
	</body>
</html>
<script src="js/startMove.js"></script>
<script src="js/jquery-1.11.3.js"></script>
<script src="js/ajax.js"></script>
<script src="js/cookie.js"></script>
<script src="js/query.js"></script>
<script>
	//登录成功的时候，要在首页获取cookie，顶部信息变化
		var username=getCookie("username");
		var yonghu=document.getElementById("yonghu");
		var xiaokunag=document.getElementById("xiaokuang");
		if(username!=""){
			yonghu.innerHTML="您好，"+username+" 欢迎您回来！<a href=''> 用户中心 </a><a onclick='exit()'> 退出 </a>";//a标签中点击事件onclick，不是href指向
			xiaokuang.innerHTML="您好，"+username+" 欢迎您回来！<a href=''> 用户中心 </a><a onclick='exit()'> 退出 </a>";//a标签中点击事件onclick
		}else{
			yonghu.innerHTML="您好！ 欢迎光临本店！<a href='login.html'>[登录]</a> <a href='zhuce.html'>[会员注册]</a>";
			xiaokuang.innerHTML="您好！ 欢迎光临本店！<a href='login.html'>[登录]</a> <a href='zhuce.html'>[会员注册]</a>";
		}
		function exit()
		{
			//删除cookie，innerHTML变为初始状态
			setCookie("username","",-1);
			setCookie("password","",-1);
			yonghu.innerHTML="您好！ 欢迎光临本店！<a href='login.html'>[登录]</a> <a href='zhuce.html'>[会员注册]</a>";
			xiaokuang.innerHTML="您好！ 欢迎光临本店！<a href='login.html'>[登录]</a> <a href='zhuce.html'>[会员注册]</a>";
		}
	//顶部的样式
	var fuwu=document.getElementById("fuwu");
	var ol=fuwu.getElementsByTagName("ol")[0];
	var span=fuwu.getElementsByTagName("span")[0];
	var daohang=document.getElementById("daohang");
	var ols=daohang.getElementsByTagName("ol")[0];
	var spans=daohang.getElementsByTagName("span")[0];
	fuwu.onmouseover=function(event){
		event=event||window.event;
		ol.style.display="block";
		fuwu.style.background="#fff";
		span.innerHTML="&and;"
		ol.style.zIndex=10;
		document.onmouseout=function(){
			ol.style.display="none";
			fuwu.style.background="none";
			span.innerHTML="&or;"
		}
	}
	daohang.onmouseover=function(event){
		event=event||window.event;
		ols.style.display="block";
		daohang.style.background="#fff";
		spans.innerHTML="&and;"
		ols.style.zIndex=10;
		document.onmouseout=function(){
			ols.style.display="none";
			daohang.style.background="none";
			spans.innerHTML="&or;"
		}
	}
	
	var hy=document.getElementsByClassName("hy")[0];
	var span=hy.getElementsByTagName("span")[0];
	var huiyuan=document.getElementById("huiyuan");
	var a=hy.getElementsByTagName("a")[0];
	hy.onmouseover=function(event){
		event=event||window.event;
		huiyuan.style.display="block";
		span.innerHTML="&and;";
		a.style.borderTopColor="red";
		a.style.borderLeftColor="red";
		a.style.borderRightColor="red";
		a.style.borderBottomColor="#fff";
		a.style.background="#fff";
		huiyuan.style.zIndex=11;
		document.onmouseout=function(){
			huiyuan.style.display="none";
			a.style.background="none";
			span.innerHTML="&or;"
			a.style.borderColor="#fafafa";
		}
	}
	var hs=document.cookie;
		var liulan=document.getElementById("liulan");
		var ul1=document.createElement("ul");
		liulan.appendChild(ul1);
		var arr1=hs.split("; ");
		var l=arr1.length;
		for(var i=0;i<l;i++){
			var col1=arr1[i].split("=");
			if(/^h\d+$/.test(col1[0])){
				var o=JSON.parse(decodeURIComponent(col1[1]));
				//console.log(o);
				var li1=document.createElement("li");
				li1.style.cssText="width:40px; height:25px;border:1px solid gray; float:left; overflow: hidden;";
				ul1.appendChild(li1);
				var img0=document.createElement("img");
				img0.src="img/"+o.img;
				img0.style.cssText="width:40px; height:23px; margin-top: 0;"
				
				var a=document.createElement("a");
				a.href="show.html?id="+o.id;
				a.appendChild(img0);
				li1.appendChild(a);
			}
		}
	

	var id=query("id");
	var str=getCookie("h"+id);
	var goods;
	if(str!=""){
		goods=JSON.parse(str);
	}
	// 放大镜
	small.src="img/"+goods.img;
	big.src="img/"+goods.img;
	var baseWidth=300;
	var baseHeight=300;//基本的宽高
	var b=2;//比例
	//div1,div2的宽高
	div1.style.width=div2.style.width=small.style.width=baseWidth+"px";
	div1.style.Height=div2.style.height=small.style.height=baseHeight+"px";
	//大图片的宽高
	big.style.width=baseWidth*b+"px";
	big.style.height=baseHeight*b+"px";
	//镜子的宽高
	glass.style.width=baseWidth/b+"px";
	glass.style.height=baseHeight/b+"px";
	//鼠标划入的时候，镜子和div2 出现，画出的时候隐藏
	div1.onmouseout=function(event){
		event=event||window.event;
		glass.style.display="none";
		div2.style.display="none";
	}
	div1.onmouseover=function(event){
		event=event||window.event;
		glass.style.display="block";
		div2.style.display="block";
	}
	//镜子跟鼠标滑动
	div1.onmousemove=function(event){
		event=event||window.event;
		var x=event.clientX-box.offsetLeft-div1.offsetLeft-glass.offsetWidth/2;
		var y=event.clientY-box.offsetTop-div1.offsetTop-glass.offsetHeight/2+$(document).scrollTop();
		//限制范围拖拽
		if(x<=0)x=0;
		if(x>div1.offsetWidth-glass.offsetWidth)x=div1.offsetWidth-glass.offsetWidth
		if(y<=0)y=0;
		if(y>div1.offsetHeight-glass.offsetHeight)y=div1.offsetHeight-glass.offsetHeight;
		
		glass.style.left=x+"px";
		glass.style.top=y+"px";
		big.style.left=x*-b+"px";
		big.style.top=y*-b+"px";
	}
	
	//小轮播
	var xiaolun=document.getElementById("xiaolun");
	xiaolun.style.cssText="width:410px; height:50px; border:1px solid gray; margin-bottom:20px;margin-left:25px;overflow: hidden;"
	var zhong=document.getElementById("zhong");	
	var moreImg=document.createElement("ul");
	moreImg.style.position="absolute";
	zhong.appendChild(moreImg);
	
	var morePic=goods.imgs;
	var l=morePic.length;//7
	//console.log(l);
	moreImg.style.width=72*l+"px";//ul的宽度
	moreImg.style.height=50+"px";
	moreImg.style.border="1px solid gray;"
	
	for(var i=0;i<l;i++){
		var liImg=document.createElement("li");
		liImg.style.cssText="width:70px; height:50px;border-right:1px solid gray; float:left;"
		moreImg.appendChild(liImg);
		var tu=document.createElement("img");
		tu.style.cssText="width:70px;height:50px;"
		tu.src="img/"+morePic[i];
		liImg.appendChild(tu);
		tu.onclick=function(){
			small.src=big.src=this.src;
		}
	}
	var timer;
	//console.log(zhong.previousElementSibling)
	//鼠标划入的时候
	zhong.previousElementSibling.onmouseover=function(){
		clearInterval(timer);
		timer=setInterval(function(){
			zhong.scrollLeft--;
			if(zhong.scrollLeft==0){
				clearInterval(timer);
			}
		},20)
	}
	
	zhong.nextElementSibling.onmouseover=function(){
		clearInterval(timer);
		timer=setInterval(function(){
			zhong.scrollLeft++;
			if(zhong.scrollLeft==120){
				clearInterval(timer);
			}
		},20)
	}



	/*//分享到qq等小图标
	var span1=document.createElement("span");
	left.appendChild(span1);
	span1.style.cssText="width:410px; height:30px; line-height:30px; text-align:left; border-top:1px solid #eeeeee; display: block; margin-top: 365px;";
	var img1=document.createElement("img");
	span1.appendChild(img1);
	img1.src="img/fenxiang.jpg";
	img1.style.cssText="margin-left:13px;";
	var span2=document.createElement("span");
	span2.innerHTML="分享到：";
	span2.style.cssText="font-size: 13px; margin-left:5px";
	span1.appendChild(span2);
	var img2=document.createElement("img");
	img2.src="img/kongjian.jpg";
	span1.appendChild(img2);*/
	//标题
	var h2=document.getElementById("h");
	h2.innerHTML=goods.title+"（本产品快递配送暂不支持西藏区域）";
	h2.style.cssText="font-size: 20px; margin-left:10px;margin-top:45px;"
	//价格
	var price=document.getElementById("price");
	price.style.cssText="width:570px;height:92px;background: #e10616;text-align: center;color:#fff;font-size: 20px;line-height: 92px;margin-bottom:30px;margin-top:50px;";
	price.innerHTML="商城价：￥"+goods.price+"元 赠送"+goods.fen+"积分";
	
	var kucun=document.getElementById("kucun");
	kucun.style.cssText="margin-bottom:23px; margin-left:23px;"
	kucun.innerHTML="库存"+goods.kucun+"件";
	
	//加减号
	var changeNum=document.getElementById("changeNum");
	changeNum.style.cssText="width:82px;height:46px;border:1px solid gray;position: relative;float: left; margin-left:15px;";
	var inputs=changeNum.getElementsByTagName("input");
	inputs[0].style.cssText="width:52px; height:46px;";
	
	var n=inputs[0].value;//变量n来表示数量
	n=1;//初始值为1，数量至少为1
	inputs[0].value=n;
	inputs[1].style.cssText="width:30px; height:23px;position: absolute;top:0;right:0;border-left:1px solid #999;border-bottom:1px solid #999;"
	inputs[2].style.cssText="width:30px; height:23px;position: absolute;bottom:0;right:0;border-left:1px solid #999;";
	inputs[1].onclick=function(){
		n++;
		inputs[0].value=n;
		goods.num=n;
		setCookie("g"+goods.id,JSON.stringify(goods),10);//更新cookie
		price.innerHTML="商城价：￥"+goods.price*n+"元"+"赠送"+goods.fen+"积分";	
	}
	inputs[2].onclick=function(){
			if(n<=1){
				inputs[0].value=1;
			}else{
				n--;
				inputs[0].value=n;
				goods.num=n;
				setCookie("g"+goods.id,JSON.stringify(goods),10);//更新cookie
				price.innerHTML="商城价：￥"+goods.price*n+"元"+"赠送"+goods.fen+"积分";
			}
		}//对于加减号的处理，在执行减号操作的时候先判断是不是1是的话就让他等于一，不是的话就执行减减
		

	//加入购物车按钮
	var addbtn=document.getElementById("addbtn");
	var addbtncart=document.getElementById("addbtncart");
	addbtn.innerHTML="立即购买";
	addbtncart.innerHTML="加入购物车";
	addbtn.style.cssText="width:150px;height:48px;background: #e10616;display: inline-block;float:left;text-align: center; line-height: 48px;color:#fff; margin-left:10px;";
	addbtncart.style.cssText="width:138px;height:46px;background: #ffeded;display: inline-block;float:left;text-align: center; line-height: 48px;color:#e10616; margin-left:10px;border:1px solid #e10616";
	
	//加入购物车绑定点击事件，并存cookie,接收到的商品是goods
		//商品对像存在addbtncart的goodes属性中
		var shuliang=document.getElementById("shuliang");
		var str=document.cookie;
		if(str!=""){
			var arr=str.split("; ");
			var l=arr.length;
			var allNum=0;
			var allPrice=0;
			for(var i=0;i<l;i++){
				var col=arr[i].split("=");
				if(/^g\d+$/.test(col[0])){
					var o=JSON.parse(decodeURIComponent(col[1]));
					allNum+=Number(o.num);//总数量	
					allPrice+=o.price*o.num;
				}
			}
			shuliang.innerHTML="购物车有"+allNum+"件商品，总价格为￥"+allPrice+"元";
			
			//点击购物车的时候，实现跳转和
			addbtncart.onclick=function(){
				var username=getCookie("username");
				if(username!=""){
					location.href="gouwuche.html";
					var id=query("id");
					var str=getCookie("g"+id);
					if(str==""){
						goods.num=1;
						setCookie("g"+goods.id,JSON.stringify(goods),10);
						shuliang.innerHTML="购物车有"+(allNum+1)+"件商品，总价格为￥"+Number(o.price)+allPrice+"元";
					}else{
						var o=JSON.parse(str);//存下商品对像
						o.num=Number(o.num)+1;//对象才有num属性，
						o.price=Number(o.price);
						setCookie("g"+o.id,JSON.stringify(o),10);
						shuliang.innerHTML="购物车有"+(allNum+o.num)+"件商品，总价格为￥"+Number(o.price*o.num+allPrice)+"元";
					}	
				}else{
					alert("为了购物安全，请先登录");
				}
			}
		}
  //right区域
  	$("#right").css({
  		"color":"#999",
  		"font-size":"15px",
  		"line-height":"30px",
  		"padding-left":"10px"
  	})
  	$("#pinpai").html("品牌："+goods.pinpai);
  	$("#shangjia").html("上架时间："+goods.shangjia);
  	$("#spbianhao").html("商品编号："+goods.hao);
</script>